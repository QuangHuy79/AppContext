ğŸ§© BÆ°á»›c 8 â€“ AuthContext
ğŸ¯ Má»¥c Ä‘Ã­ch tá»•ng thá»ƒ
AuthContext chá»‹u trÃ¡ch nhiá»‡m quáº£n lÃ½ toÃ n bá»™ tráº¡ng thÃ¡i xÃ¡c thá»±c (authentication state) cá»§a á»©ng dá»¥ng, bao gá»“m:

LÆ°u trá»¯ vÃ  kiá»ƒm soÃ¡t user, token, vÃ  tráº¡ng thÃ¡i Ä‘Äƒng nháº­p.

Cung cáº¥p API login/logout cho toÃ n app.

Tá»± Ä‘á»™ng phá»¥c há»“i phiÃªn (restore session) khi app khá»Ÿi Ä‘á»™ng.

Äá»“ng bá»™ tráº¡ng thÃ¡i auth lÃªn global AppContext náº¿u cáº§n (vÃ­ dá»¥: hiá»ƒn thá»‹ toast khi login thÃ nh cÃ´ng, hoáº·c logout toÃ n app).

TÃ³m gá»n:

AuthContext chÃ­nh lÃ  â€œbá»™ nÃ£oâ€ kiá»ƒm soÃ¡t ai Ä‘ang Ä‘Äƒng nháº­p, dÆ°á»›i danh tÃ­nh nÃ o, vÃ  token Ä‘ang há»£p lá»‡ hay khÃ´ng.

âš™ï¸ Chá»©c nÄƒng chÃ­nh cá»§a AuthContext
Chá»©c nÄƒng	MÃ´ táº£
1. login(credentials)	Gá»­i yÃªu cáº§u xÃ¡c thá»±c (qua authService), náº¿u thÃ nh cÃ´ng thÃ¬ lÆ°u token + user vÃ o context vÃ  localStorage.
2. logout()	XÃ³a token vÃ  user, reset state, cÃ³ thá»ƒ hiá»ƒn thá»‹ toast â€œÄÃ£ Ä‘Äƒng xuáº¥tâ€.
3. restoreSession()	Khi á»©ng dá»¥ng load láº¡i, tá»± Ä‘á»™ng láº¥y token vÃ  user tá»« localStorage Ä‘á»ƒ khÃ´i phá»¥c session.
4. isAuthenticated	Biáº¿n boolean giÃºp cÃ¡c component kiá»ƒm tra nhanh tráº¡ng thÃ¡i login.
5. loading/error	Cho phÃ©p hiá»ƒn thá»‹ spinner hoáº·c bÃ¡o lá»—i khi Ä‘Äƒng nháº­p.
ğŸ§  LÃ½ do cáº§n AuthContext riÃªng
Hiá»‡n táº¡i, há»‡ thá»‘ng AppContext cá»§a báº¡n Ä‘Ã£ cÃ³:

NetworkContext â†’ quáº£n lÃ½ máº¡ng

DeviceContext â†’ thÃ´ng tin thiáº¿t bá»‹

SettingsContext â†’ theme + locale

UIContext â†’ giao diá»‡n (toast, modal, v.v.)

DataContext â†’ dá»¯ liá»‡u ná»™i bá»™

ğŸ‘‰ NhÆ°ng chÆ°a cÃ³ module nÃ o chá»‹u trÃ¡ch nhiá»‡m quáº£n lÃ½ user & quyá»n truy cáº­p.

AuthContext láº¥p chá»— trá»‘ng nÃ y, giÃºp:

ToÃ n bá»™ app biáº¿t rÃµ â€œai Ä‘ang dÃ¹ng appâ€.

CÃ¡c module khÃ¡c (nhÆ° DataContext hoáº·c UIContext) cÃ³ thá»ƒ pháº£n á»©ng theo auth state (vÃ­ dá»¥: clear data khi logout).

Dá»… dÃ ng má»Ÿ rá»™ng thÃªm logic phÃ¢n quyá»n (role-based access control).

ğŸ”„ CÃ¡ch AuthContext hÃ²a vÃ o há»‡ thá»‘ng hiá»‡n táº¡i
DÃ¹ng dispatch tá»« AppContext Ä‘á»ƒ Ä‘á»“ng bá»™ cÃ¡c action global (náº¿u báº¡n muá»‘n hiá»ƒn thá»‹ toast hoáº·c trigger data reload sau login).

ÄÆ°á»£c bá»c trong AppProvider cÃ¹ng DataProvider, nhá» Ä‘Ã³ toÃ n bá»™ app cÃ³ thá»ƒ gá»i useAuth() Ä‘á»ƒ truy cáº­p nhanh user, login, logout, v.v.

ğŸ’¡ TÃ³m táº¯t ngáº¯n gá»n
Má»¥c tiÃªu	Káº¿t quáº£ mong muá»‘n
Quáº£n lÃ½ tráº¡ng thÃ¡i xÃ¡c thá»±c ngÆ°á»i dÃ¹ng	âœ… CÃ³ AuthContext vá»›i user, token, isAuthenticated
Cung cáº¥p API login/logout	âœ… CÃ³ hook useAuth() tiá»‡n dá»¥ng
Giá»¯ token bá»n vá»¯ng qua refresh	âœ… LÆ°u & restore tá»« localStorage
TÃ­ch há»£p nháº¹ nhÃ ng vÃ o AppProvider	âœ… Bao quanh DataProvider hoáº·c song song
Chuáº©n bá»‹ ná»n cho cÃ¡c bÆ°á»›c sau (VD: PermissionsContext hoáº·c ProfileContext)	ğŸš€ CÃ³ thá»ƒ má»Ÿ rá»™ng dá»… dÃ ng

ğŸ§­ Luá»“ng hoáº¡t Ä‘á»™ng AuthContext
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      App khá»Ÿi cháº¡y    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ AuthProvider khá»Ÿi táº¡o       â”‚
      â”‚ â†’ gá»i restoreSession()      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Láº¥y token + user tá»«         â”‚
      â”‚ localStorage (náº¿u cÃ³)       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ CÃ³ token?           
                 â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                        â”‚
     â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ isAuthenticated=true â”‚  isAuthenticated=false â”‚
â”‚ user restored         â”‚  user=null, token=nullâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AppProvider nháº­n state auth   â”‚
â”‚ CÃ¡c component cÃ³ thá»ƒ gá»i useAuth() â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš™ï¸ Khi ngÆ°á»i dÃ¹ng login
User â†’ gá»i login(credentials)
          â”‚
          â–¼
  authService.login()  âŸ¶ (fake API / real API)
          â”‚
          â–¼
  Nháº­n user + token
          â”‚
          â–¼
  LÆ°u vÃ o localStorage
          â”‚
          â–¼
  Cáº­p nháº­t AuthContext state
          â”‚
          â–¼
  dispatch("AUTH/LOGIN_SUCCESS")
          â”‚
          â–¼
  ToastService hiá»ƒn thá»‹ â€œÄÄƒng nháº­p thÃ nh cÃ´ngâ€

ğŸšª Khi ngÆ°á»i dÃ¹ng logout
User â†’ gá»i logout()
          â”‚
          â–¼
  XÃ³a user + token khá»i state
  XÃ³a token khá»i localStorage
  dispatch("AUTH/LOGOUT")
          â”‚
          â–¼
  ToastService hiá»ƒn thá»‹ â€œÄÃ£ Ä‘Äƒng xuáº¥tâ€
  DataContext cÃ³ thá»ƒ reset dá»¯ liá»‡u náº¿u cáº§n
